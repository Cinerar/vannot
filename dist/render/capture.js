const $=require("jquery"),{immediate}=require("../util"),{notify}=require("./chrome"),capture=(e,t)=>new Promise((i=>{const o=document.createElement("canvas");o.width=e.width,o.height=e.height;const r=o.getContext("2d"),n=document.createElement("video");n.crossOrigin="anonymous",n.src=e.source;const m=t.slice(),c={},a=immediate((()=>{const s=m.pop();(e=>{const u=()=>{4===n.readyState?(r.drawImage(n,0,0),o.toBlob((e=>{c[s]=e,notify(`Exported frame ${t.length-m.length} of ${t.length}.`),0===m.length?i(c):a()}),"image/jpeg",.6)):d()},d=immediate((()=>{setTimeout(u,150)}))})(),n.currentTime=s/e.fps}))}));module.exports={capture};